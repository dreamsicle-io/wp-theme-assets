# WP Theme Assets 

A simple, zero configuration [Gulp](https://gulpjs.com) build &amp; lint setup for developing modern [WordPress](https://wordpress.org) themes.

This package is built entirely on Gulp 4, and will lint, build and optimize `.js` and `.scss` assets, generate `.pot` language localization files, and optimize images. This package will also create the required `style.css` file and its formatted header comment, as well as the required, [theme directory](https://wordpress.org/themes) friendly `README.md` file with all it's content; all generated by the theme root's `package.json` data. 

Finally, this package also includes a `WP_Theme_Assets` [php class](https://github.com/dreamsicle-io/wp-theme-assets/blob/master/package/includes/class-wp-theme-assets.php), located in `includes/class-wp-theme-assets.php`. This class beautifully handles all script and stylesheet enqueues of built assets automatically. 

## Getting Started

The best way to scaffold this project is to use [@dreamsicle.io/create-wp-theme](https://github.com/dreamsicle-io/create-wp-theme). This is a node command line utility that will allow walk you through a prompt in the command line.

### 1. Scaffold a Theme

**From the WordPress install's `wp-content/themes` directory, run `create-wp-theme`:**

```shell
npx @dreamsicle.io/create-wp-theme my-theme
```

### 2. Install Dependencies

**Navigate to the newly created theme directory:**

```shell
cd path/to/theme
```

**Run the install command:**

```shell
npm install
```

### 3. Run a production build.

**From the theme's root, run the build command:**

```shell
npm run build
```

> **Note:** This will create a directory at `assets/dist` and build all `.css` and `.js` files, as well as optimize all images. This will also create a `languages` directory and place a built `.pot` file inside of it. Lastly, this will build the required `style.css` and `README.md` files in the theme root.

### 4. Run a development build and watch for changes.

**From the theme's root, run the build command:**

```shell
npm start
```

### 5. Initialize WP_Theme_Assets Class

The included `WP_Theme_Assets` [php class](https://github.com/dreamsicle-io/wp-theme-assets/blob/master/package/includes/class-wp-theme-assets.php), found at `includes/class-wp-theme-assets.php`, beautifully handles all script and stylesheet enqueues of built assets automatically. It also loads the theme textdomain and registers the languages directory.

**Place the following snippet in the theme's `functions.php` file:**

```php
// Require the class-wp-theme-assets.php file.
require get_template_directory() . '/includes/class-wp-theme-assets.php';

// Hook the `WP_Theme_Assets` class's `init()` method to `after_setup_theme`. 
add_action( 'after_setup_theme', array( new WP_Theme_Assets, 'init' ), 0 );
```

> **Note:** This is hooked at priority `0` to allow the class's methods to use `after_setup_theme` also. 

## Development Commands

The included [gulpfile](https://github.com/dreamsicle-io/wp-theme-assets/blob/master/package/gulpfile.js) contains all tasks that handle linting and building in this package. The included [development commands](https://github.com/dreamsicle-io/wp-theme-assets/blob/master/package/package.json), found on the `scripts` key in the `package.json` file, control all top level commands needed for this setup to function properly.

### Install

This command will install all dependencies listed on the `devDependencies` key in the `package.json` file. This will generate a `package-lock.json` file and a `node_modules` directory in the theme root, both of which are ignored in the `.gitignore` file by default.

```shell
npm install
```

### Start

This command will start the `default` task, which runs the `lint`, `build:assets`, and `watch` tasks in series.

```shell
npm start
```

### Build

This command will start the `build` task, which runs the `clean`, `build:assets`, and `zip` tasks in series.

```shell
npm run build
```

### Lint

This command will start the `fix` task, which runs the `fix:php`, `fix:sass`, and `fix:js` tasks in series.

```shell
npm run fix
```

### Fix

This command will start the `lint` task, which runs the `lint:php`, `lint:sass`, and `lint:js` tasks in series.

```shell
npm run lint
```

### Clean

This command will start the `clean` task, which will delete all built assets including those inside the `assets/dist` directory, as well as `languages/{textdomain}.pot`, `REAMDE.md`, and `style.css`.

```shell
npm run clean
```

## File structure 

This gulp setup expects that the project root's `package.json` is setup properly, and that an [opinionated file structure](https://github.com/dreamsicle-io/wp-theme-assets/tree/master/package) is followed. The localization tasks are handled by the built in WordPress localization functions in all theme `.php` files, but the [source assets](https://github.com/dreamsicle-io/wp-theme-assets/tree/master/package/assets) should be structured accordingly.

### Source Files 

``` 
root 
―――― /assets 
―――― ―――― /src 
―――― ―――― ―――― /js 
―――― ―――― ―――― ―――― /modules 
―――― ―――― ―――― ―――― site.js 
―――― ―――― ―――― ―――― admin.js 
―――― ―――― ―――― ―――― login.js 
―――― ―――― ―――― ―――― customizer-preview.js 
―――― ―――― ―――― ―――― customizer-controls.js 
―――― ―――― ―――― /md 
―――― ―――― ―――― ―――― DESCRIPTION.js 
―――― ―――― ―――― ―――― FAQ.js 
―――― ―――― ―――― ―――― COPYRIGHT.js 
―――― ―――― ―――― ―――― CHANGELOG.js 
―――― ―――― ―――― /sass 
―――― ―――― ―――― ―――― /modules 
―――― ―――― ―――― ―――― site.scss 
―――― ―――― ―――― ―――― admin.scss 
―――― ―――― ―――― ―――― login.scss 
―――― ―――― ―――― ―――― editor.scss 
―――― ―――― ―――― ―――― customizer-preview.scss 
―――― ―――― ―――― ―――― customizer-controls.scss 
―――― ―――― ―――― /images 
``` 

### Build Files 

``` 
root 
―――― /assets 
―――― ―――― /dist 
―――― ―――― ―――― /js 
―――― ―――― ―――― ―――― site.min.js 
―――― ―――― ―――― ―――― site.min.js.map 
―――― ―――― ―――― ―――― admin.min.js 
―――― ―――― ―――― ―――― admin.min.js.map 
―――― ―――― ―――― ―――― login.min.js 
―――― ―――― ―――― ―――― login.min.js.map 
―――― ―――― ―――― ―――― customizer-preview.min.js 
―――― ―――― ―――― ―――― customizer-preview.min.js.map 
―――― ―――― ―――― ―――― customizer-controls.min.js 
―――― ―――― ―――― ―――― customizer-controls.min.js.map 
―――― ―――― ―――― /css 
―――― ―――― ―――― ―――― site.min.css 
―――― ―――― ―――― ―――― site.min.css.map 
―――― ―――― ―――― ―――― admin.min.css 
―――― ―――― ―――― ―――― admin.min.css.map 
―――― ―――― ―――― ―――― login.min.css 
―――― ―――― ―――― ―――― login.min.css.map 
―――― ―――― ―――― ―――― editor.min.css 
―――― ―――― ―――― ―――― editor.min.css.map 
―――― ―――― ―――― ―――― customizer-preview.min.css 
―――― ―――― ―――― ―――― customizer-preview.min.css.map 
―――― ―――― ―――― ―――― customizer-controls.min.css 
―――― ―――― ―――― ―――― customizer-controls.min.css.map 
―――― ―――― ―――― /images 
―――― /languages 
―――― ―――― {textdomain}.pot 
―――― README.md 
―――― style.css 
```
